import{d as k,i as p,q as w,l as g,t as B,u as x,m as se,a as A,w as P,o as R,f as y,F as G,z as ae,j as V,k as D,v as I,A as U,s as M,n as W,S as re,U as ce,y as f,B as ie,af as le,c as Q,Q as ue}from"./vue-62e5e94d.js";import{_ as N,u as q,b as K,s as E,p as de,a as pe,d as ve,c as me}from"./index-ba3bee82.js";import{g as _e}from"./getMessageFromError-0a4f3a23.js";import{h as fe}from"./document-83d6e226.js";import{B as ge}from"./specRenderer-eed37316.js";import{f as Se}from"./fetchAll-7bf8532b.js";import"./kongponents-5a8d94e7.js";const he={key:0,class:"mb-3"},ye=k({__name:"Section",props:{title:{type:String,default:null}},setup(e){return(l,c)=>(p(),w("section",null,[e.title?(p(),w("header",he,[g("h2",null,B(e.title),1)])):x("",!0),se(l.$slots,"default",{},void 0,!0)]))}});const H=N(ye,[["__scopeId","data-v-13bc53f2"]]),Ie=k({name:"DocumentTree",props:{documents:{type:Array,required:!0},productId:{type:String,required:!0},activeDocumentId:{type:String,default:null},level:{type:Number,default:1},parentDocumentSlug:{type:String,default:""}},setup:e=>{const l=A({});function c(o,a){const u=a.reduce((i,d)=>(i[d.id]=!0,i),{});if(o){l.value=u;const i=a.find(d=>d.id===o||fe(d.children||[],o));i&&(u[i.id]=!1)}l.value=u}return P([()=>e.activeDocumentId,()=>e.documents],([o,a])=>{c(o,a)}),R(()=>{c(e.activeDocumentId,e.documents)}),{isNodeCollapsedMap:l}}});const be=e=>(re("data-v-71b5b1f1"),e=e(),ce(),e),De=be(()=>g("div",null,null,-1)),we={class:"expandable-node-container"},Ve=["onClick"],Te={class:"children",role:"region",tabindex:"-1"};function Pe(e,l,c,o,a,u){const i=y("router-link"),d=y("KIcon"),v=y("DocumentTree",!0),S=y("KCollapse");return p(),w("ul",null,[(p(!0),w(G,null,ae(e.documents,t=>(p(),w("li",{key:t.id},[t.children&&t.children.length?(p(),V(S,{key:0,modelValue:e.isNodeCollapsedMap[t.id],"onUpdate:modelValue":s=>e.isNodeCollapsedMap[t.id]=s,class:"collapse-container"},{trigger:D(()=>[De]),"visible-content":D(()=>[g("div",we,[I(i,{to:{name:"api-documentation-page",params:{product:e.productId,slug:[e.parentDocumentSlug,t.slug].filter(Boolean)}},style:U({paddingLeft:`${e.level-1}rem`}),class:M({title:!0})},{default:D(()=>[W(B(t.title),1)]),_:2},1032,["to","style"]),g("button",{class:M(["expand-button",e.isNodeCollapsedMap[t.id]?null:"expand-icon"]),onClick:s=>e.isNodeCollapsedMap[t.id]=!e.isNodeCollapsedMap[t.id]},[I(d,{icon:"chevronDown",size:"16"})],10,Ve)])]),default:D(()=>[g("div",null,[g("div",Te,[I(v,{documents:t.children,"active-document-id":e.activeDocumentId,"product-id":e.productId,level:e.level+1,"parent-document-slug":t.slug},null,8,["documents","active-document-id","product-id","level","parent-document-slug"])])])]),_:2},1032,["modelValue","onUpdate:modelValue"])):(p(),V(i,{key:1,to:{name:"api-documentation-page",params:{product:e.productId,slug:[e.parentDocumentSlug,t.slug].filter(Boolean)}},class:M({title:!0}),style:U({paddingLeft:`${e.level-1}rem`})},{default:D(()=>[W(B(t.title),1)]),_:2},1032,["to","style"]))]))),128))])}const Ae=N(Ie,[["render",Pe],["__scopeId","data-v-71b5b1f1"]]),$e=k({__name:"SectionOverview",props:{product:{type:Object,required:!0}},setup(e){const l=e,c=q().state.helpText.sectionOverview,o=K(),{documentTree:a,activeDocumentId:u}=E(o);return(i,d)=>f(a).length&&l.product?(p(),V(H,{key:0,title:f(c).title},{default:D(()=>[I(Ae,{documents:f(a),"product-id":l.product.id,"active-document-id":f(u)},null,8,["documents","product-id","active-document-id"])]),_:1},8,["title"])):x("",!0)}}),Ce=k({__name:"SectionReference",props:{product:{type:Object,required:!0},activeProductVersionId:{type:String,required:!0},deselectOperation:{type:Boolean,default:!1}},emits:["operationSelected"],setup(e,{emit:l}){const c=e,o=A(null),a=A(!0),u=K();async function i(){var S,t;const d=(S=c.product)==null?void 0:S.id,v=c.activeProductVersionId;if(!(!d||!v)){a.value=!0;try{const s=await de.service.versionsApi.getProductVersionSpecOperations({productId:d,versionId:v});o.value=(t=s.data.operations)==null?void 0:t.map(m=>({...m,operationId:m.operation_id})),u.setSidebarOperations(o.value)}catch(s){console.error(s)}finally{a.value=!1}}}return i(),P([()=>c.product,()=>c.activeProductVersionId],i),(d,v)=>{const S=y("KSkeleton");return e.product&&e.product.versions.length?(p(),V(H,{key:0},{default:D(()=>[a.value?(p(),V(S,{key:0})):o.value?(p(),V(f(ge),{key:1,operations:o.value,deselect:e.deselectOperation,width:"100%",class:"operations-list",onSelected:v[0]||(v[0]=t=>l("operationSelected",t))},null,8,["operations","deselect"])):x("",!0)]),_:1})):x("",!0)}}});const ke=N(Ce,[["__scopeId","data-v-4998f0fe"]]),Oe={class:"px-5 py-6 content"},Be={class:"mb-6"},xe={class:"title mb-5"},Ne=k({__name:"Sidebar",props:{deselectOperation:{type:Boolean,default:!1}},emits:["operationSelected"],setup(e,{emit:l}){const c=K(),{product:o,activeProductVersionId:a}=E(c),u=q().state.helpText.sidebar,i=u.noResultsProduct,d=A([]);function v(){var t;d.value=((t=o.value)==null?void 0:t.versions.slice().sort((s,m)=>new Date(s.created_at).getTime()-new Date(m.created_at).getTime()).map(s=>({value:s.id,label:`${s.name}${s.deprecated?u.deprecated:""}`,selected:s.id===a.value})))||[]}function S(t){var m;const s=(m=o.value)==null?void 0:m.versions.find(T=>T.id===t.value);s&&c.setActiveProductVersionId(s.id)}return R(()=>{v()}),P([()=>o.value,()=>a.value],()=>{v()}),(t,s)=>{var T;const m=y("KSelect");return p(),w("aside",null,[g("div",Oe,[g("header",Be,[g("span",xe,B((T=f(o))==null?void 0:T.name),1),I(m,{appearance:"select",class:"version-select-dropdown",width:"100%","data-testid":"version-select-dropdown","enable-filtering":!1,items:d.value,onChange:S},{empty:D(()=>[g("div",null,B(f(i)),1)]),_:1},8,["items"])]),I($e,{product:f(o)},null,8,["product"]),I(ke,{"active-product-version-id":f(a),product:f(o),"deselect-operation":e.deselectOperation,onOperationSelected:s[0]||(s[0]=b=>l("operationSelected",b))},null,8,["active-product-version-id","product","deselect-operation"])])])}}});const Ke=N(Ne,[["__scopeId","data-v-1028d2fc"]]);function Me(e,l="asc"){return(c,o)=>{const a=new Date(c[e]).getTime(),u=new Date(o[e]).getTime();return a===u?0:l==="asc"?a>u?1:-1:a<u?1:-1}}const Re={class:"container flex pb-0 product fixed-position"},qe={class:"sidebar-wrapper"},Ee={class:"content"},Le=k({__name:"ProductShell",setup(e){const{notify:l}=me(),c=q().state.helpText,o=ie(),a=le(),{portalApiV2:u}=pe(),i=A(null),d=A(!1),v=A(!1),S=c.productVersion.deprecatedWarningProduct,t=K(),{product:s,documentTree:m,activeDocumentSlug:T,activeProductVersionId:b}=E(t),$=Q(()=>o.params.product),O=Q(()=>o.params.product_version);function L(){const n=o.params.slug,r=Array.isArray(n)?n[n.length-1]:n;r!==T.value&&t.setActiveDocumentSlug(r)}const{productsApi:J,versionsApi:X,documentationApi:Y}=u.value.service;async function Z(){const n=$.value;try{const{data:r}=await J.getProduct({productId:n}),_={...r,versions:await Se(h=>X.listProductVersions({...h,productId:n}))};t.setProduct(_)}catch(r){console.error(r),i.value=_e(r)}}async function ee(){const n=$.value;try{const r={productId:n,accept:ve.DocumentContentTypeEnum.VndKonnectDocumentTreejson},_=await Y.listProductDocuments(r);t.setDocumentTree(_.data.data)}catch(r){r.response.status===404?t.setDocumentTree([]):(console.error(r),l({appearance:"danger",message:c.productVersion.unableToRetrieveDoc}))}}function z(){var _,h;if(!s.value)return;const n=s.value.versions.slice().sort(Me("created_at"));if(!n)return;const r=(_=O.value)==null?void 0:_.toLowerCase();if(r){const C=n.find(j=>{var F;return j.id===r||((F=j.name)==null?void 0:F.toLowerCase())===r});C&&t.setActiveProductVersionId(C.id)}b.value||t.setActiveProductVersionId((h=n[0])==null?void 0:h.id)}function te(n){n&&a.replace({name:"api-documentation-page",params:{product:o.params.product,slug:[n]}})}function oe(){o.name==="spec"&&(t.setSidebarActiveOperation(null),a.push({name:"spec",params:{product:$.value,product_version:b.value}}))}function ne(n){const r={name:"spec",params:{product:$.value,product_version:b.value}};o.name!=="spec"?a.push(r).then(()=>t.setSidebarActiveOperation(n)):a.replace(r).then(()=>t.setSidebarActiveOperation(n))}return R(async()=>{L(),await Z(),await ee(),z()}),P(()=>O.value,()=>{O.value&&O.value!==b.value&&t.setActiveProductVersionId(O.value),z()}),P(()=>o.name,()=>{v.value=o.name!=="spec"}),P(()=>b.value,(n,r)=>{var h;if(r&&n!==r&&oe(),!((h=s.value)!=null&&h.version_count))return;const _=s.value.versions.filter(C=>C.id===b.value)[0];d.value=_==null?void 0:_.deprecated}),P(()=>$.value,()=>{var n;$.value!==((n=s.value)==null?void 0:n.id)&&t.setProduct(null)}),ue(()=>{var n;if(L(),m.value&&!T.value&&o.path.includes("/docs/")){const r=(n=m.value[0])==null?void 0:n.slug;te(r)}}),(n,r)=>{const _=y("EmptyState"),h=y("KAlert"),C=y("router-view");return p(),w("div",Re,[i.value?(p(),V(_,{key:0,"is-error":"",class:"mt-6",message:i.value},null,8,["message"])):(p(),w(G,{key:1},[g("div",qe,[I(Ke,{class:"sidebar","deselect-operation":v.value,onOperationSelected:ne},null,8,["deselect-operation"])]),g("div",Ee,[d.value?(p(),V(h,{key:0,appearance:"warning","alert-message":f(S),class:"deprecated-warning"},null,8,["alert-message"])):x("",!0),I(C,{product:f(s)},null,8,["product"])])],64))])}}});const He=N(Le,[["__scopeId","data-v-b267a02a"]]);export{He as default};
